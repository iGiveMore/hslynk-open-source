/*! BootsFaces 2020-05-02 */

var app=angular.module("app",["ngRoute","ngStorage","ngAnimate","route-segment","view-segment","ui.bootstrap"]),header={sessionToken:""};app.directive("fileModel",["$parse",function(s){return{restrict:"A",link:function(e,t,o){var r=s(o.fileModel).assign;t.bind("change",function(){e.$apply(function(){r(e,t[0].files[0])})})}}}]),app.factory("LS",["$window","$rootScope",function(t,o){return angular.element(t).on("storage",function(e){"my-storage"===e.key&&o.$apply()}),{setData:function(e){return t.localStorage&&t.localStorage.setItem("my-storage",e),this},getData:function(){return t.localStorage&&t.localStorage.getItem("my-storage")}}}]),app.config(["$routeSegmentProvider","$routeProvider",function(e,t){e.options.autoLoadTemplates=!0,e.when("/login","s1").when("/login","s4").when("/admin","s2.dashboard").when("/admin/dashboard","s2.dashboard").when("/admin/managefiles","s2.managefiles").when("/admin/bulkupload","s2.bulkupload").when("/admin/bulkuploadNew","s2.bulkuploadNew").when("/admin/managesync","s2.managesync").when("/admin/managereport","s2.managereport").when("/admin/manageexport","s2.manageexport").when("/admin/manageeligreq","s2.manageeligreq").when("/admin/setting","s2.setting").when("/admin/requestreport","s2.requestreport").when("/admin/requestexport","s2.requestexport").when("/admin/mergeclient","s2.mergeclient").when("/admin/unmergeclient","s2.unmergeclient").when("/admin/createprojgrp","s2.createprojgrp").when("/admin/manageprojgrp","s2.manageprojgrp").when("/admin/createorg","s2.createorg").when("/admin/manageorg","s2.manageorg").when("/admin/createprofile","s2.createprofile").when("/admin/manageprofile","s2.manageprofile").when("/admin/createrole","s2.createrole").when("/admin/managerole","s2.managerole").when("/admin/createuser","s2.createuser").when("/admin/manageuser","s2.manageuser").when("/admin/onboardfellow","s2.onboardfellow").when("/admin/errormessage/:id","s2.errormessage").when("/admin/updatepassword/:id","s2.updatepassword").when("/admin/onboardfellowgroup","s2.onboardfellow.onboardfellowgroup").when("/admin/onboardfellowuser","s2.onboardfellow.onboardfellowuser").segment("s1",{templateUrl:"templates/login.html"}).segment("s4",{templateUrl:"templates/login.html",controller:"logoutCtrl"}).segment("s2",{templateUrl:"templates/root.html"}).within().segment("dashboard",{templateUrl:"templates/partial/dashboard.html",controller:"dashboardCtrl"}).segment("managefiles",{templateUrl:"templates/partial/managefiles.html",controller:"managefilesCtrl"}).segment("errormessage",{templateUrl:"templates/partial/errormessage.html",controller:"errormessageCtrl"}).segment("updatepassword",{templateUrl:"templates/partial/updatepassword.html",controller:"updateUserPwdCtrl"}).segment("manageuser",{templateUrl:"templates/partial/manageuser.html",controller:"manageuserCtrl"}).segment("managereport",{templateUrl:"templates/partial/managereport.html",controller:"managereportCtrl"}).segment("manageexport",{templateUrl:"templates/partial/manageexport.html",controller:"manageexportCtrl"}).segment("manageeligreq",{templateUrl:"templates/partial/manageeligreq.html",controller:"manageeligreqCtrl"}).segment("bulkupload",{templateUrl:"templates/partial/bulkupload.html",controller:"bulkUploadCtrl"}).segment("bulkuploadNew",{templateUrl:"templates/partial/bulkuploadnew.html",controller:"bulkUploadNewCtrl"}).segment("managesync",{templateUrl:"templates/partial/managesync.html",controller:"managesyncCtrl"}).segment("setting",{templateUrl:"templates/partial/setting.html",controller:"settingCtrl"}).segment("requestreport",{templateUrl:"templates/partial/requestreport.html",controller:"requestreportCtrl"}).segment("requestexport",{templateUrl:"templates/partial/requestexport.html",controller:"requestexportCtrl"}).segment("mergeclient",{templateUrl:"templates/partial/mergeclient.html",controller:"mergeclientCtrl"}).segment("unmergeclient",{templateUrl:"templates/partial/unmergeclient.html",controller:"unmergeclientCtrl"}).segment("createorg",{templateUrl:"templates/partial/createorg.html",controller:"createorgCtrl"}).segment("manageorg",{templateUrl:"templates/partial/manageorg.html",controller:"manageorgCtrl"}).segment("createprofile",{templateUrl:"templates/partial/createprofile.html",controller:"createprofileCtrl"}).segment("manageprofile",{templateUrl:"templates/partial/manageprofile.html",controller:"manageprofileCtrl"}).segment("createrole",{templateUrl:"templates/partial/createrole.html",controller:"createroleCtrl"}).segment("manageprofile",{templateUrl:"templates/partial/managerole.html",controller:"manageroleCtrl"}).segment("createprojgrp",{templateUrl:"templates/partial/createprojgrp.html",controller:"createprojgrpCtrl"}).segment("manageprojgrp",{templateUrl:"templates/partial/manageprojgrp.html",controller:"manageprojgrpCtrl"}).segment("createuser",{templateUrl:"templates/partial/createuser.html",controller:"createuserCtrl"}).segment("manageuser",{templateUrl:"templates/partial/manageuser.html",controller:"manageuserCtrl"}).segment("onboardfellow",{templateUrl:"templates/partial/onboardfellow.html",controller:"onboardfellowCtrl"}).within().segment("onboardfellowgroup",{templateUrl:"templates/partial/onboardfellowgroup.html",controller:"onboardfellowgroupCtrl"}).segment("onboardfellowuser",{templateUrl:"templates/partial/onboardfellowuser.html",controller:"onboardfellowuserCtrl"}).up(),t.otherwise({redirectTo:"/login"})}]),app.run(["$rootScope","$location","$sessionStorage","$http",function(e,t,o,r){null!=o.account&&null!=o.account.roles&&(e.roleName=o.account.roles[0].roleName),"/admin/dashboard"!=t.path()&&"/login"!=t.path()&&null==o.isLoggedIn&&t.path("/login")}]),app.value("loader",{show:!1}),app.directive("ssnInput",function(){return{require:"ngModel",link:function(e,t,o,r){var s;$(t).mask("999-99-9999");var n=/^(\d{3}-?\d{2}-?\d{4})$/;$(t).focusin(function(){$(t).val(s)}),$(t).on("blur",function(){s=$(t).val(),n.test($(t).val())&&$(t).val("XXX-XX"+s.slice(6))})}}}),app.directive("appFilereader",["$q",function(e){Array.prototype.slice;return{restrict:"A",require:"?ngModel",link:function(e,t,o,r){r&&(r.$render=function(){},t.bind("change",function(e){var t=e.target;r.$setViewValue(t)}))}}}]);var filesCollection="",Service={GetProjectList:function(e,t,o,r){e({method:"GET",url:"/hmis-clientapi-v2017/rest/v2/projects?maxItems=200",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+r.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){t&&t(e.projects.projects)}).error(o)},GetUserInfo:function(e,t,o,r){e({method:"GET",url:"/hmis-user-service/rest/accounts/self/basicinfo",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},DownloadPDF:function(e,t,o,r){e({method:"POST",url:"/hmis-report-service/rest/reports/download/"+t.downloadId+"/pdf",responseType:"arraybuffer",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e,t,o){var r=(o=o())["x-filename"],s=o["content-type"],n=document.createElement("a");try{var a=new Blob([e],{type:s}),i=window.URL.createObjectURL(a);n.setAttribute("href",i),n.setAttribute("download",r);var l=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});n.dispatchEvent(l)}catch(e){console.log(e)}}).error(function(e){console.log(e)})},DownloadZIP:function(e,t,o,r){e({method:"POST",url:"/hmis-report-service/rest/reports/download/"+t.downloadId+"/zip",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose","Content-Type":"application/zip"}}).success(function(e,t,o){(o=o())["x-filename"],o["content-Type"];var r=document.createElement("a");document.body.appendChild(r),r.style="display: none";var s=new Blob([e],{type:"application/zip"}),n=window.URL.createObjectURL(s);r.href=n,r.download=name,r.click(),window.URL.revokeObjectURL(n)})},DownloadExportZIP:function(e,t,o,r){e({method:"POST",url:"/hmis-report-service/rest/reports/download/"+t.exportId+"/zip",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose","Content-Type":"application/zip"}}).success(function(e,t,o){var r=(o=o())["x-filename"],s=(o["content-type"],document.createElement("a"));try{var n=new Blob([e],{type:"application/zip"}),a=window.URL.createObjectURL(n);s.setAttribute("href",a),s.setAttribute("download",r);var i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1});s.dispatchEvent(i)}catch(e){console.log(e)}}).error(function(e){console.log(e)})},GetUserByOrganization:function(e,t,o,r){t.organizationId="b5598c6c-d021-4f5f-9695-77f7f4685ed2",e({method:"GET",url:"/hmis-user-service/rest/accounts/"+t.organizationId+"/users",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e.accounts)}).error(r)},GetReports:function(e,t,o){e({method:"GET",url:"/hmis-report-service/rest/reports",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){t&&t(e.ReportConfigs.reportConfigs)})},GetExports:function(e,t,o){e({method:"GET",url:"/hmis-report-service/rest/export",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){t&&t(e.FileExports.fileExports)})},GetFilesListRECENT:function(e,t,o){e({method:"GET",url:"/hmis-upload-service/rest/bulk-upload?status=RECENT",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){t&&t(e.BulkUploads.bulkUploads)})},GetFilesListSTAGING:function(e,t,o){e({method:"GET",url:"/hmis-upload-service/rest/bulk-upload?status=STAGING",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){t&&t(e.BulkUploads.bulkUploads)})},GetFilesListDELETED:function(e,t,o){e({method:"GET",url:"/hmis-upload-service/rest/bulk-upload?status=DELETED",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){t&&t(e.BulkUploads.bulkUploads)})},GetFilesListLIVE:function(e,t,o){e({method:"GET",url:"/hmis-upload-service/rest/bulk-upload?status=LIVE",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){t&&t(e.BulkUploads.bulkUploads)})},GetFilesListERROR:function(e,t,o){e({method:"GET",url:"/hmis-upload-service/rest/bulk-upload?status=ERROR",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){t&&t(e.BulkUploads.bulkUploads)})},GetFilesLogList:function(e,t,o){e({method:"GET",url:"/hmis-clientapi-v"+o.year+"/rest/bulkupload/activities/"+o.idForLog,headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){t&&t(e)})},GetErrorMessage:function(e,t,o){e({method:"GET",url:"/hmis-clientapi-v"+o.year+"/rest/bulkupload/errors/"+o.id,headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){t&&t(e.bulkUploadErrors.bulkUploadErrors)})},GetSyncFilesList:function(e,t){e.get("/hmis-bulk-loader-v2014/sync").success(function(e){t&&t(e)})},CheckServiceAvailableBulkUpload:function(e,t,o,r){e({method:"GET",url:"/hmis-upload-service/rest/bulk-upload?status=STAGING",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e.BulkUploads.bulkUploads)}).error(r)},CheckServiceAvailableUploadFile:function(e,t,o,r){e.post("/hmis-upload-service/uploadFile",{headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},CheckServiceAvailableAuthenticate:function(e,t,o,r){e.post("/hmis-client-dedup/rest/api/v1/authenticate",{headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},LoadStatistics:function(t,o,r){t.get("/hmis-upload-service/rest/bulk-upload?status=LIVE",{headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){filesCollection=e.BulkUploads.bulkUploads,t.get("/hmis-upload-service/rest/bulk-upload?status=STAGING",{headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){Array.prototype.push.apply(filesCollection,e.BulkUploads.bulkUploads),t.get("/hmis-upload-service/rest/bulk-upload?status=ERROR",{headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+o.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){Array.prototype.push.apply(filesCollection,e.BulkUploads.bulkUploads),r(filesCollection)})})})},logout:function(e,t,o,r){e({method:"DELETE",url:"/hmis-user-service/rest/sessions/"+t.sessionToken,headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)})},SaveSetting:function(e,t,o,r){e({method:"POST",url:"/hmis-user-service/rest/accounts",data:{account:{username:t.emailAddress,emailAddress:t.emailAddress,password:t.password,firstName:t.firstName,lastName:t.lastName,accountId:t.accountId}},headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},submitHivePasswordForm:function(e,t,o,r){e({method:"POST",url:"/hmis-user-service/rest/accounts",data:{account:{username:t.emailAddress,emailAddress:t.emailAddress,password:t.password,firstName:t.firstName,lastName:t.lastName,accountId:t.accountId}},headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},MergeClient:function(e,t,o,r){data=t.form;var s="/hmis-globalapi/rest/clients/"+data.clientId+"/dedup/merge";data=t.form,e({method:"POST",url:s,data:{client:{firstName:data.firstName,lastName:data.lastName,ssn:data.ssn,dob:data.dob}},headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},UnMergeClient:function(e,t,o,r){data=t.form;var s="/hmis-globalapi/rest/clients/"+data.clientId+"/dedup/unmerge";data=t.form,e({method:"POST",url:s,data:{client:{firstName:data.firstName,lastName:data.lastName,ssn:data.ssn,dob:data.dob}},headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},Events:function(e,t,o,r,s){e({method:"POST",url:"/hmis-globalapi/rest/events",data:{event:{payload:{projectGroupCode:o.projectGroupCode,clientId:o.clientId,targetDedupId:o.dedupClientId},eventType:o.eventType}},headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){r&&r(e)}).error(s)},SendRequestReport:function(e,t,o,r){data=t.form;data=t.form,e({method:"POST",url:"/hmis-report-service/rest/reports",data:{reportConfig:{name:data.name,startDate:data.startDate,endDate:data.endDate,reportType:data.reportType,reportLevel:data.reportLevel,projectIds:data.project}},headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},SendRequestExport:function(e,t,o,r){data=t.form;data=t.form,e({method:"POST",url:"/hmis-report-service/rest/export",data:{fileExport:{name:data.name,startDate:data.startDate,endDate:data.endDate,exportType:data.reportType,exportLevel:data.reportLevel,projectIds:data.project}},headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},bulkupload:function(e,t,o,r,s){var n=new FormData;n.append("version",t.form.version),n.append("fileName",t.fileName),n.append("bucketName",t.bucketName),e.post("/hmis-upload-service/rest/upload",n,{transformRequest:angular.identity,headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,"Content-Type":void 0}}).success(function(){r()}).error(s)},bulkuploadNew:function(e,t,o,r,s,n){var a="/hmis-upload-service/rest/bulk-upload/"+t.form.version,i=new FormData;i.append("file",o),e.post(a,i,{transformRequest:angular.identity,headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,"Content-Type":void 0}}).success(function(){s()}).error(n)},GetRoles:function(e,t,o){e({method:"GET",url:"/hmis-user-service/rest/roles?maxItems=10",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)})},GetProfiles:function(e,t,o){e.get("/hmis-user-service/rest/profiles?maxItems=10",{headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)})},GetProjectGroups:function(e,t,o){e({method:"GET",cache:!1,url:"/hmis-user-service/rest/projectgroups?maxItems=100",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)})},GetEligReq:function(e,t,o){e({method:"GET",data:"",cache:!1,url:"/inventory-api/rest/projects/eligibilityrequirements?page=0&size=100",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose","Content-Type":"application/json"}}).success(function(e){o&&o(e)})},getAccountById:function(e,t,o,r){e({method:"GET",url:"/hmis-user-service/rest/accounts/"+t.accountId,headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},createUser:function(e,t,o,r){data=t.form,e({method:"POST",url:"/hmis-user-service/rest/accounts",data:{account:{username:data.username,emailAddress:data.emailAddress,password:data.password,confirmPassword:data.confirmPassword,firstName:data.firstName,middleName:data.middleName,lastName:data.lastName,role:{id:data.role.id},projectGroup:{projectGroupId:data.projectgroup.projectGroupId},profile:{id:data.profile.id}}},headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},updateAccountPassword:function(e,t,o,r){var s="/hmis-user-service/rest/accounts/"+t.username+"/passwordupdate";data=t.form,e({method:"PUT",url:s,data:{passwordChange:{newPassword:data.newPassword,confirmNewPassword:data.confirmNewPassword}},headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},createRole:function(e,t,o,r){data=t.form,e({method:"POST",url:"/hmis-user-service/rest/roles",data:{role:{roleName:data.name,roleDescription:data.desc}},headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},createProjectGroup:function(e,t,o,r){console.warn(t,2);data=t.form,e({method:"POST",url:"/hmis-user-service/rest/projectgroups",data:{projectGroup:{projectGroupName:data.name,projectGroupDesc:data.desc,skipuseridentifers:data.skipuseridentifers}},headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",Authorization:"HMISUserAuth session_token="+t.sessionToken,Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},getToken:function(e,t,o,r){e({method:"POST",url:"/hmis-authorization-service/rest/token?grant_type=authorization_code&code="+t.authToken+"&redirect_uri=http://ec2-52-38-189-237.us-west-2.compute.amazonaws.com:8080/hmis-admin/#/admin/dashboard",headers:{"X-HMIS-TrustedApp-Id":"MASTER_TRUSTED_APP",authorization:"Basic:TUFTVEVSX1RSVVNURURfQVBQOkhNSVM=",Accept:"application/json;odata=verbose"}}).success(function(e){o&&o(e)}).error(r)},_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,o,r,s,n,a,i,l="",c=0;for(e=_utf8_encode(e);c<e.length;)s=(t=e.charCodeAt(c++))>>2,n=(3&t)<<4|(o=e.charCodeAt(c++))>>4,a=(15&o)<<2|(r=e.charCodeAt(c++))>>6,i=63&r,isNaN(o)?a=i=64:isNaN(r)&&(i=64),l=l+this._keyStr.charAt(s)+this._keyStr.charAt(n)+this._keyStr.charAt(a)+this._keyStr.charAt(i);return l},decode:function(e){var t,o,r,s,n,a,i="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)t=this._keyStr.indexOf(e.charAt(l++))<<2|(s=this._keyStr.indexOf(e.charAt(l++)))>>4,o=(15&s)<<4|(n=this._keyStr.indexOf(e.charAt(l++)))>>2,r=(3&n)<<6|(a=this._keyStr.indexOf(e.charAt(l++))),i+=String.fromCharCode(t),64!=n&&(i+=String.fromCharCode(o)),64!=a&&(i+=String.fromCharCode(r));return i=_utf8_decode(i)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",o=0;o<e.length;o++){var r=e.charCodeAt(o);r<128?t+=String.fromCharCode(r):(127<r&&r<2048?t+=String.fromCharCode(r>>6|192):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128)),t+=String.fromCharCode(63&r|128))}return t}};app.controller("bulkUploadCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(s,n,e,a,t,i){s.sessionToken=i.sessionToken,i.isLoggedIn&&$("#userDetails").html(i.account.emailAddress);var u={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,o,r,s,n,a,i,l="",c=0;for(e=u._utf8_encode(e);c<e.length;)s=(t=e.charCodeAt(c++))>>2,n=(3&t)<<4|(o=e.charCodeAt(c++))>>4,a=(15&o)<<2|(r=e.charCodeAt(c++))>>6,i=63&r,isNaN(o)?a=i=64:isNaN(r)&&(i=64),l=l+this._keyStr.charAt(s)+this._keyStr.charAt(n)+this._keyStr.charAt(a)+this._keyStr.charAt(i);return l},decode:function(e){var t,o,r,s,n,a,i="",l=0;for(e=e.replace(/[^A-Za-z0-9+/=]/g,"");l<e.length;)t=this._keyStr.indexOf(e.charAt(l++))<<2|(s=this._keyStr.indexOf(e.charAt(l++)))>>4,o=(15&s)<<4|(n=this._keyStr.indexOf(e.charAt(l++)))>>2,r=(3&n)<<6|(a=this._keyStr.indexOf(e.charAt(l++))),i+=String.fromCharCode(t),64!=n&&(i+=String.fromCharCode(o)),64!=a&&(i+=String.fromCharCode(r));return i=u._utf8_decode(i)},_utf8_encode:function(e){e=e.replace(/rn/g,"n");for(var t="",o=0;o<e.length;o++){var r=e.charCodeAt(o);r<128?t+=String.fromCharCode(r):(127<r&&r<2048?t+=String.fromCharCode(r>>6|192):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128)),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){for(var t="",o=0,r=c1=c2=0;o<e.length;)(r=e.charCodeAt(o))<128?(t+=String.fromCharCode(r),o++):191<r&&r<224?(c2=e.charCodeAt(o+1),t+=String.fromCharCode((31&r)<<6|63&c2),o+=2):(c2=e.charCodeAt(o+1),c3=e.charCodeAt(o+2),t+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),o+=3);return t}};a.get("./config.json").then(function(e){var t=e.data;AWS.config.update({accessKeyId:u.decode(t.aKey),secretAccessKey:u.decode(t.sKey),region:u.decode(t.reg)})}),s.submitForm=function(o){s.projectGroupCode=i.account.projectGroup.projectGroupCode,s.infoTextAlert="Please wait uploading....",s.showInfoAlert=!0,s.showSuccessAlert=!1,s.showErrorAlert=!1;var e=new AWS.S3({params:{Bucket:i.account.projectGroup.bucketName.toLocaleLowerCase(),Prefix:"testfolder"}}),r=$("input[type='file'")[0].files[0];if(r){var t={Key:r.name,ContentType:r.type,Body:r,xhrFields:{withCredentials:!0}};e.upload(t).on("httpUploadProgress",function(e){console.log("Uploaded :: "+parseInt(100*e.loaded/e.total)+"%"),$(".bg-info").html("Please wait uploading.... "+parseInt(100*e.loaded/e.total)+"%")}).send(function(e,t){if(e)return s.successTextAlert="There was an error uploading your Hmis upload:"+e.message,!1;s.fileName=r.name,s.bucketName="sdolia-2015",Service.bulkupload(a,s,o,function(){s.switchBool("showInfoAlert"),s.successTextAlert="File has been uploaded successfully.",s.showInfoAlert=!1,s.showSuccessAlert=!0,n.path("/admin/managefiles")},function(){n.path("/admin/managefiles"),s.switchBool("showInfoAlert"),s.errorTextAlert="Error, Something gone wrong.",s.showInfoAlert=!1,s.showErrorAlert=!0})})}return!1},s.switchBool=function(e){s[e]=!s[e]}}]),app.controller("bulkUploadNewCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,o,e,r,s,n){t.sessionToken=n.sessionToken,n.isLoggedIn&&$("#userDetails").html(n.account.emailAddress),t.submitForm=function(){t.infoTextAlert="Please wait uploading....",t.showInfoAlert=!0;var e=t.form.inputfile;Service.bulkuploadNew(r,t,e,function(e){console.log("percent: "+parseInt(100*e.loaded/e.total)),t.infoTextAlert=parseInt(100*e.loaded/e.total)},function(){t.switchBool("showInfoAlert"),t.successTextAlert="File has been uploaded successfully.",t.showSuccessAlert=!0,o.path("/admin/managefiles")},function(){t.switchBool("showInfoAlert"),t.errorTextAlert="Error, Something gone wrong.",t.showErrorAlert=!0})},t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("createorgCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,e,o,r,s,n){n.isLoggedIn&&$("#userDetails").html(n.account.emailAddress),Service.GetProjectList(r,function(e){t.projects=e}),t.submitForm=function(){Service.SendRequestReport(r,t,function(e){t.successTextAlert="Your request has been sent successfully.",t.showSuccessAlert=!0,t.form.email="",t.form.report="",t.form.year="",t.form.project=""},function(){t.errorTextAlert="Error, Something gone wrong.",t.showErrorAlert=!0})},t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("createprojgrpCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,e,o,r,s,n){t.sessionToken=n.sessionToken,n.isLoggedIn&&$("#userDetails").html(n.account.emailAddress),t.submitForm=function(){Service.createProjectGroup(r,t,function(e){t.successTextAlert="Your request has been sent successfully.",t.showSuccessAlert=!0,t.form.name="",t.form.desc=""},function(){t.errorTextAlert="Error, Something gone wrong.",t.showErrorAlert=!0})},t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("createprojgrpCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,e,o,r,s,n){t.sessionToken=n.sessionToken,n.isLoggedIn&&$("#userDetails").html(n.account.emailAddress),Service.GetProjectList(r,function(e){t.projects=e}),t.submitForm=function(){Service.createProjectGroup(r,t,function(e){t.successTextAlert="Your request has been sent successfully.",t.showSuccessAlert=!0,t.form.name="",t.form.desc=""},function(){t.errorTextAlert="Error, Something gone wrong.",t.showErrorAlert=!0})},t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("createuserCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,e,o,r,s,n){t.sessionToken=n.sessionToken,n.isLoggedIn&&$("#userDetails").html(n.account.emailAddress),Service.GetProfiles(r,t,function(e){t.profiles=e.profiles.profile}),Service.GetRoles(r,t,function(e){t.roles=e.roles.role}),Service.GetProjectGroups(r,t,function(e){t.projectgroups=e.projectgroups.projectGroups}),t.submitForm=function(){t.errorTextAlert="",t.showErrorAlert=!1,Service.createUser(r,t,function(e){t.successTextAlert="Your request has been sent successfully.",t.showSuccessAlert=!0,t.form.firstName="",t.form.lastName="",t.form.username="",t.form.password="",t.form.emailAddress=""},function(e){t.errorTextAlert=e.errors.error[0].message,t.showErrorAlert=!0})},t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("dashboardCtrl",["$rootScope","$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,o,r,e,s,n,a){o.authToken=r.search().code,"SUPERADMIN"==t.roleName?$(".dashboard").show():$(".dashboard").hide();function i(){Service.CheckServiceAvailableBulkUpload(s,o,function(e){$("#divBulkUpload .button-success").css("display","inline")},function(){$("#divBulkUpload .button-error").css("display","inline")}),Service.CheckServiceAvailableUploadFile(s,o,function(e){$("#divUploadFile .button-success").css("display","inline")},function(){$("#divUploadFile .button-success").css("display","inline")}),Service.CheckServiceAvailableAuthenticate(s,o,function(e){$("#divAuthenticate .button-success").css("display","inline")},function(){$("#divAuthenticate .button-success").css("display","inline")}),Service.LoadStatistics(s,o,function(e){o.managefiles=e})}a.authToken=o.authToken,a.sessionToken?(o.sessionToken=a.sessionToken,i()):(Service.getToken(s,o,function(e){a.sessionToken=e.oAuthAuthorization.accessToken,a.expiresIn=e.oAuthAuthorization.expiresIn,a.tokenType=e.oAuthAuthorization.tokenType,a.isLoggedIn=!0,o.sessionToken=e.oAuthAuthorization.accessToken,o.expiresIn=e.oAuthAuthorization.expiresIn,o.tokenType=e.oAuthAuthorization.tokenType,i(),Service.GetUserInfo(s,o,function(e){a.account=e.account,$("#userDetails").html(e.account.emailAddress),t.roleName=a.account.roles[0].roleName,a.roleName=a.account.roles[0].roleName,"SUPERADMIN"==t.roleName?$(".dashboard").show():$(".dashboard").hide()},function(){a.isLoggedIn?$("#userDetails").html(a.account.emailAddress):r.path("/login")}),"SUPERADMIN"==t.roleName?$(".dashboard").show():$(".dashboard").hide()},function(){a.isLoggedIn?$("#userDetails").html(a.account.emailAddress):r.path("/login")}),"SUPERADMIN"==t.roleName?$(".dashboard").show():$(".dashboard").hide())}]),app.controller("errormessageCtrl",["$scope","$location","$routeParams","$routeSegment","$http","$timeout","$sessionStorage",function(t,e,o,r,s,n,a){a.isLoggedIn&&$("#userDetails").html(a.account.emailAddress),t.sessionToken=a.sessionToken;var i=o.id.split("-");t.id=i[0],t.year=i[1],Service.GetErrorMessage(s,function(e){t.listErrorMessage=e,t.currentPageErrorMessage=1,t.entryLimitErrorMessage=10,t.filteredItemsErrorMessage=t.listErrorMessage.length,t.totalItemsErrorMessage=t.listErrorMessage.length},t),t.setPageErrorMessage=function(e){t.currentPageErrorMessage=e}}]),app.controller("validateLoginCtrl",["$scope","$location","$routeSegment",function(e,t,o){e.SubmitLogin=function(){"admin@servinglynk.com"==e.email&&"admin"==e.password?t.path(o.getSegmentUrl("s2.dashboard")):alert("Invalid username & password")}}]),app.controller("logoutCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,e,o,r,s,n){n.isLoggedIn&&$("#userDetails").html(n.account.emailAddress),t.sessionToken=n.sessionToken,delete n.sessionToken,delete n.sessionToken,delete n.expiresIn,delete n.tokenType,delete n.authToken,delete n.isLoggedIn,delete n.account,Service.logout(r,t,function(){},function(){}),t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("manageeligreqCtrl",["$scope","$location","$routeSegment","$http","$timeout","$modal","$sessionStorage",function(t,e,o,r,s,n,a){a.isLoggedIn&&$("#userDetails").html(a.account.emailAddress),t.sessionToken=a.sessionToken,Service.GetEligReq(r,t,function(e){t.list=e.content,t.currentPage=1,t.entryLimit=10,t.filteredItems=t.list.length,t.totalItems=t.list.length},function(e){}),t.setPage=function(e){t.currentPage=e},t.viewRequirements=function(e){n.open({templateUrl:"templates/partial/vieweligreq.html",controller:"viewEligReqCtrl",resolve:{datajson:function(){return e.requirements}}})}}]),app.controller("viewEligReqCtrl",["$scope","$location","$routeSegment","$http","$timeout","datajson",function(e,t,o,r,s,n){e.datajson=n}]),app.controller("manageexportCtrl",["$scope","$location","$routeSegment","$http","$modal","$timeout","$sessionStorage",function(o,e,t,r,s,n,a){a.isLoggedIn&&$("#userDetails").html(a.account.emailAddress),o.sessionToken=a.sessionToken,Service.GetExports(r,function(e){o.list=e,o.currentPage=1,o.entryLimit=10,o.filteredItems=o.list.length,o.totalItems=o.list.length},o),o.setPage=function(e){o.currentPage=e},o.openlog=function(e){o.projectIds=e,console.log("Projects"+e);s.open({templateUrl:"templates/partial/exportprojectspopopup.html",controller:"ModalInstanceLogCtrl",resolve:{datajson:function(){return e}}})},o.downloadZIP=function(t){console.log("export config:"+t),o.exportId=t,Service.DownloadExportZIP(r,o,function(e){console.log("export config download success :"+t)},function(e){})}}]),app.controller("ModalInstanceLogCtrl",["$scope","$location","$routeSegment","$http","$timeout","datajson",function(e,t,o,r,s,n){e.datajson=n}]),app.filter("startFrom",function(){return function(e,t){return e?(t=+t,e.slice(t)):[]}}),app.controller("ModalInstanceLogCtrl",["$scope","$location","$routeSegment","$http","$timeout","datajson",function(e,t,o,r,s,n){e.datajson=n}]),app.controller("managefilesCtrl",["$scope","$location","$routeSegment","$http","$timeout","$modal","$sessionStorage",function(o,e,t,r,s,n,a){a.isLoggedIn&&$("#userDetails").html(a.account.emailAddress),o.sessionToken=a.sessionToken,Service.GetFilesListRECENT(r,function(e){o.listRECENT=e,o.currentPageRECENT=1,o.entryLimitRECENT=10,o.filteredItemsRECENT=o.listRECENT.length,o.totalItemsRECENT=o.listRECENT.length},o),o.setPageRECENT=function(e){o.currentPageRECENT=e},Service.GetFilesListSTAGING(r,function(e){o.listSTAGING=e,o.currentPageSTAGING=1,o.entryLimitSTAGING=10,o.filteredItemsSTAGING=o.listSTAGING.length,o.totalItemsSTAGING=o.listSTAGING.length},o),o.setPageSTAGING=function(e){o.currentPageSTAGING=e},Service.GetFilesListLIVE(r,function(e){o.listLIVE=e,o.currentPageLIVE=1,o.entryLimitLIVE=10,o.filteredItemsLIVE=o.listLIVE.length,o.totalItemsLIVE=o.listLIVE.length},o),o.setPageLIVE=function(e){o.currentPageLIVE=e},Service.GetFilesListERROR(r,function(e){o.listERROR=e,o.currentPageERROR=1,o.entryLimitERROR=10,o.filteredItemsERROR=o.listERROR.length,o.totalItemsERROR=o.listERROR.length},o),o.setPageERROR=function(e){o.currentPageERROR=e},Service.GetFilesListDELETED(r,function(e){o.listDELETED=e,o.currentPageDELETED=1,o.entryLimitDELETED=10,o.filteredItemsDELETED=o.listDELETED.length,o.totalItemsDELETED=o.listDELETED.length},o),o.setPageDELETED=function(e){o.currentPageDELETED=e},o.openlog=function(e,t){o.idForLog=e,o.year=t,Service.GetFilesLogList(r,function(e){n.open({templateUrl:"templates/partial/syncfilelogpopopup.html",controller:"ModalInstanceLogCtrl",resolve:{datajson:function(){return e.bulkUploadActivities.bulkUploadActivities}}})},o)}}]),app.controller("manageprojgrpCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,e,o,r,s,n){n.isLoggedIn&&$("#userDetails").html(n.account.emailAddress),t.sessionToken=n.sessionToken,Service.GetProjectGroups(r,t,function(e){t.list=e.projectgroups.projectGroups,t.currentPage=1,t.entryLimit=10,t.filteredItems=t.list.length,t.totalItems=t.list.length},function(e){}),t.setPage=function(e){t.currentPage=e}}]),app.controller("managereportCtrl",["$scope","$location","$routeSegment","$http","$modal","$timeout","$sessionStorage",function(o,e,t,r,s,n,a){a.isLoggedIn&&$("#userDetails").html(a.account.emailAddress),o.sessionToken=a.sessionToken,Service.GetReports(r,function(e){o.list=e,o.currentPage=1,o.entryLimit=10,o.filteredItems=o.list.length,o.totalItems=o.list.length},o),o.setPage=function(e){o.currentPage=e},o.openlog=function(e){o.projectIds=e,console.log("Projects"+e);s.open({templateUrl:"templates/partial/reportprojectspopopup.html",controller:"ModalInstanceLogCtrl",resolve:{datajson:function(){return e}}})},o.downloadZIP=function(t){console.log("Report config:"+t),o.downloadId=t,Service.DownloadZIP(r,o,function(e){console.log("Report config download success :"+t)},function(e){})},o.downloadPDF=function(t){console.log("Report config:"+t),o.downloadId=t,Service.DownloadPDF(r,o,function(e){console.log("Report config download success :"+t)},function(e){})}}]),app.controller("ModalInstanceLogCtrl",["$scope","$location","$routeSegment","$http","$timeout","datajson",function(e,t,o,r,s,n){e.datajson=n}]),app.controller("ModalInstanceCtrl",["$scope","$location","$routeSegment","$http","$timeout","datajson",function(e,t,o,r,s,n){e.datajson=n}]),app.controller("managesyncCtrl",["$scope","$location","$routeSegment","$http","$timeout","$modal","$sessionStorage",function(t,e,o,r,s,n,a){a.isLoggedIn&&$("#userDetails").html(a.account.emailAddress),Service.GetSyncFilesList(r,function(e){t.listSTAGING=e,t.currentPageSTAGING=1,t.entryLimitSTAGING=10,t.filteredItemsSTAGING=t.listSTAGING.length,t.totalItemsSTAGING=t.listSTAGING.length}),t.setPageSTAGING=function(e){t.currentPageSTAGING=e},t.openModel=function(e){n.open({templateUrl:"templates/partial/syncpopopup.html",controller:"ModalInstanceCtrl",resolve:{datajson:function(){return e.json.replace("}","").replace("{","").split(",")}}})}}]),app.controller("manageuserCtrl",["$scope","$location","$routeSegment","$http","$timeout","$modal","$sessionStorage",function(t,e,o,r,s,n,a){t.sessionToken=a.sessionToken,a.isLoggedIn&&$("#userDetails").html(a.account.emailAddress),Service.GetUserByOrganization(r,t,function(e){t.list=e.account,t.currentPage=1,t.entryLimit=10,t.filteredItems=t.list.length,t.totalItems=t.list.length},function(e){}),t.setPage=function(e){t.currentPage=e},t.openlog=function(e,t){n.open({templateUrl:"templates/partial/updatepasswordpopup.html",controller:"ModalInstanceLogCtrl",resolve:{datajson:function(){return{id:e,username:t}}}})}}]),app.controller("mergeclientCtrl",["$scope","$location","$routeSegment","$http","$modal","$timeout","$sessionStorage",function(t,e,o,r,s,n,a){a.isLoggedIn&&$("#userDetails").html(a.account.emailAddress),t.sessionToken=a.sessionToken,t.submitForm=function(){Service.MergeClient(r,t,function(e){s.open({templateUrl:"templates/partial/mergeclientpopup.html",controller:"ModalInstanceLogCtrl",resolve:{datajson:function(){return e.client}}});t.successTextAlert="",t.showSuccessAlert=!0,t.form.name="",t.form.reportLevel="",t.form.reportType="",t.form.startDate="",t.form.endDate="",t.form.project=[]},function(){t.errorTextAlert="Error, Something gone wrong.",t.showErrorAlert=!0})},t.pushMerge=function(e){console.log(e),e.projectGroupCode=a.account.projectGroup.projectGroupCode,e.eventType="client.merge",Service.Events(r,t,e,function(e){console.log(e)},function(e){})},t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("onboardfellowCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(e,t,o,r,s,n){n.isLoggedIn&&$("#userDetails").html(n.account.emailAddress),e.sessionToken=n.sessionToken}]),app.controller("onboardfellowgroupCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,o,e,r,s,n){$("#createUser").removeClass("active"),$("#createGroup").addClass("active"),t.sessionToken=n.sessionToken,t.submitForm=function(){Service.createProjectGroup(r,t,function(e){t.successTextAlert="Your Requset has been sent successfully.",t.showSuccessAlert=!0,t.form.name="",t.form.desc="",o.path("/admin/onboardfellowuser")},function(){t.errorTextAlert="Error, Something gone wrong.",t.showErrorAlert=!0})},t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("onboardfellowuserCtrl",["$rootScope","$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(r,s,t,e,o,n,a){$("#createGroup").removeClass("active"),$("#createUser").addClass("active"),s.sessionToken=a.sessionToken,Service.GetProfiles(o,s,function(e){s.profiles=e.profiles.profile}),Service.GetRoles(o,s,function(e){for(var t=[],o=0;o<e.roles.role.length;o++)"SUPERADMIN"!=r.roleName&&"SUPERADMIN"==e.roles.role[o].roleName||t.push(e.roles.role[o]);s.roles=t}),Service.GetProjectGroups(o,s,function(e){s.projectgroups=e.projectgroups.projectGroups}),s.prev=function(){t.path("/admin/onboardfellowgroup")},s.submitForm=function(){s.errorTextAlert="",s.showErrorAlert=!1,Service.createUser(o,s,function(e){s.successTextAlert="Your Requset has been sent successfully.",s.showSuccessAlert=!0,s.form.firstName="",s.form.lastName="",s.form.username="",s.form.password="",s.form.emailAddress="",s.form.gender="",t.path("/admin/manageuser")},function(e){s.errorTextAlert=e.errors.error[0].message,s.showErrorAlert=!0})},s.switchBool=function(e){s[e]=!s[e]}}]),app.controller("requestexportCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,e,o,r,s,n){n.isLoggedIn&&$("#userDetails").html(n.account.emailAddress),t.sessionToken=n.sessionToken,Service.GetProjectList(r,function(e){t.projects=e},function(){t.errorTextAlert="Error, Something gone wrong with getting projects.",t.showErrorAlert=!0},t),t.submitForm=function(){Service.SendRequestExport(r,t,function(e){t.successTextAlert="Your request has been sent successfully.",t.showSuccessAlert=!0,t.form.name="",t.form.exportLevel="",t.form.exportType="",t.form.startDate="",t.form.endDate="",t.form.project=[]},function(){t.errorTextAlert="Error, Something gone wrong.",t.showErrorAlert=!0})},t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("requestreportCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,e,o,r,s,n){n.isLoggedIn&&$("#userDetails").html(n.account.emailAddress),t.sessionToken=n.sessionToken,Service.GetProjectList(r,function(e){t.projects=e},function(){t.errorTextAlert="Error, Something gone wrong with getting projects.",t.showErrorAlert=!0},t),t.submitForm=function(){Service.SendRequestReport(r,t,function(e){t.successTextAlert="Your request has been sent successfully.",t.showSuccessAlert=!0,t.form.name="",t.form.reportLevel="",t.form.reportType="",t.form.startDate="",t.form.endDate="",t.form.project=[]},function(){t.errorTextAlert="Error, Something gone wrong.",t.showErrorAlert=!0})},t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("settingCtrl",["$scope","$location","$routeSegment","$http","$timeout","$sessionStorage",function(t,e,o,r,s,n){n.isLoggedIn&&(t.sessionToken=n.sessionToken,$("#userDetails").html(n.account.emailAddress),t.emailAddress=n.account.emailAddress,t.username=n.account.emailAddress,t.role=n.account.roles.role[0].roleName,t.firstName=n.account.firstName,t.lastName=n.account.lastName,t.accountId=n.account.accountId),t.submitForm=function(){test=t,Service.SaveSetting(r,t,function(e){t.successTextAlert="Setting has been updated successfully.",t.showSuccessAlert=!0},function(){t.errorTextAlert="Error, Something gone wrong.",t.showErrorAlert=!0})},t.submitHivePasswordForm=function(){test=t,Service.updateHivePassword(r,t,function(e){t.successTextAlert="Setting has been updated successfully.",t.showSuccessAlert=!0},function(){t.errorTextAlert="Error, Something gone wrong.",t.showErrorAlert=!0})},t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("unmergeclientCtrl",["$scope","$location","$routeSegment","$http","$modal","$timeout","$sessionStorage",function(t,e,o,r,s,n,a){a.isLoggedIn&&$("#userDetails").html(a.account.emailAddress),t.sessionToken=a.sessionToken,t.submitForm=function(){Service.UnMergeClient(r,t,function(e){s.open({templateUrl:"templates/partial/unmergeclientpopup.html",controller:"ModalInstanceLogCtrl",resolve:{datajson:function(){return e.client}}});t.successTextAlert="Your unmerge was successful.",t.showSuccessAlert=!0,t.form.name="",t.form.reportLevel="",t.form.reportType="",t.form.startDate="",t.form.endDate="",t.form.project=[]},function(){t.errorTextAlert="Error, Something gone wrong.",t.showErrorAlert=!0})},t.pushUnMerge=function(e){e.projectGroupCode=a.account.projectGroup.projectGroupCode,e.eventType="client.unmerge",Service.Events(r,t,e,function(e){alert("Un merge successful!")},function(e){})},t.switchBool=function(e){t[e]=!t[e]}}]),app.controller("updateUserPwdCtrl",["$scope","$location","$routeParams","$routeSegment","$http","$timeout","$sessionStorage",function(t,e,o,r,s,n,a){t.sessionToken=a.sessionToken,a.isLoggedIn&&$("#userDetails").html(a.account.emailAddress),t.accountId=o.id,Service.getAccountById(s,t,function(e){t.username=e.account.username},function(e){console.log("error when getting accont by id")}),t.setPageErrorMessage=function(e){t.currentPageErrorMessage=e},t.submitForm=function(){t.errorTextAlert="",t.showErrorAlert=!1,Service.updateAccountPassword(s,t,function(e){t.successTextAlert="Your request has been sent successfully.",t.showSuccessAlert=!0,t.form.firstName="",t.form.lastName="",t.form.username="",t.form.password="",t.form.emailAddress=""},function(e){t.errorTextAlert=e.errors.error[0].message,t.showErrorAlert=!0})},t.switchBool=function(e){t[e]=!t[e]}}]),function(){"use strict";function e(r,s,n,t,a){var e={Login:function(e,o,r){t(function(){var t;a.GetByUsername(e).then(function(e){t=null!==e&&e.password===o?{success:!0}:{success:!1,message:"Username or password is incorrect"},r(t)})},1e3)},SetCredentials:function(e,t){var o=i.encode(e+":"+t);n.globals={currentUser:{username:e,authdata:o}},r.defaults.headers.common.Authorization="Basic "+o,s.put("globals",n.globals)},ClearCredentials:function(){n.globals={},s.remove("globals"),r.defaults.headers.common.Authorization="Basic "}};return e}angular.module("app").factory("AuthenticationService",e),e.$inject=["$http","$cookieStore","$rootScope","$timeout","UserService"];var i={keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){for(var t,o,r,s,n,a="",i="",l="",c=0;r=(t=e.charCodeAt(c++))>>2,s=(3&t)<<4|(o=e.charCodeAt(c++))>>4,n=(15&o)<<2|(i=e.charCodeAt(c++))>>6,l=63&i,isNaN(o)?n=l=64:isNaN(i)&&(l=64),a=a+this.keyStr.charAt(r)+this.keyStr.charAt(s)+this.keyStr.charAt(n)+this.keyStr.charAt(l),t=o=i="",r=s=n=l="",c<e.length;);return a},decode:function(e){var t,o,r,s,n="",a="",i="",l=0;for(/[^A-Za-z0-9\+\/\=]/g.exec(e)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");t=this.keyStr.indexOf(e.charAt(l++))<<2|(r=this.keyStr.indexOf(e.charAt(l++)))>>4,o=(15&r)<<4|(s=this.keyStr.indexOf(e.charAt(l++)))>>2,a=(3&s)<<6|(i=this.keyStr.indexOf(e.charAt(l++))),n+=String.fromCharCode(t),64!=s&&(n+=String.fromCharCode(o)),64!=i&&(n+=String.fromCharCode(a)),t=o=a="",r=s=i="",l<e.length;);return n}}}(),function(){"use strict";function e(o){var e={Success:function(e,t){o.flash={message:e,type:"success",keepAfterLocationChange:t}},Error:function(e,t){o.flash={message:e,type:"error",keepAfterLocationChange:t}}};return o.$on("$locationChangeStart",function(){var e;(e=o.flash)&&(e.keepAfterLocationChange?e.keepAfterLocationChange=!1:delete o.flash)}),e}angular.module("app").factory("FlashService",e),e.$inject=["$rootScope"]}(),function(){"use strict";function e(t){var e={GetAll:function(){return t.get("/api/users").then(o,r("Error getting all users"))},GetById:function(e){return t.get("/api/users/"+e).then(o,r("Error getting user by id"))},GetByUsername:function(e){return t.get("/api/users/"+e).then(o,r("Error getting user by username"))},Create:function(e){return t.post("/api/users",e).then(o,r("Error creating user"))},Update:function(e){return t.put("/api/users/"+e.id,e).then(o,r("Error updating user"))}};return e.Delete=Delete,e;function o(e){return e}function r(e){return function(){return{success:!1,message:e}}}}angular.module("app").factory("UserService",e),e.$inject=["$http"]}(),function(){"use strict";function e(e,s,n){var t={GetAll:function(){var e=n.defer();return e.resolve(a()),e.promise},GetById:function(e){var t=n.defer(),o=s("filter")(a(),{id:e}),r=o.length?o[0]:null;return t.resolve(r),t.promise}};return t.GetByUsername=o,t.Create=function(r){var s=n.defer();return e(function(){o(r.username).then(function(e){if(null!==e)s.resolve({success:!1,message:'Username "'+r.username+'" is already taken'});else{var t=a(),o=t[t.length-1]||{id:0};r.id=o.id+1,t.push(r),i(t),s.resolve({success:!0})}})},1e3),s.promise},t.Update=function(e){for(var t=n.defer(),o=a(),r=0;r<o.length;r++)if(o[r].id===e.id){o[r]=e;break}return i(o),t.resolve(),t.promise},t.Delete=function(e){for(var t=n.defer(),o=a(),r=0;r<o.length;r++){if(o[r].id===e){o.splice(r,1);break}}return i(o),t.resolve(),t.promise},t;function o(e){var t=n.defer(),o=s("filter")(a(),{username:e}),r=o.length?o[0]:null;return t.resolve(r),t.promise}function a(){return localStorage.users||(localStorage.users=JSON.stringify([])),JSON.parse(localStorage.users)}function i(e){localStorage.users=JSON.stringify(e)}}angular.module("app").factory("UserService",e),e.$inject=["$timeout","$filter","$q"]}();